Unused kwargs: ['bnb_8bit_quant_type', 'bnb_8bit_compute_dtype', 'bnb_8bit_use_double_quant']. These kwargs are not used in <class 'transformers.utils.quantization_config.BitsAndBytesConfig'>.
`low_cpu_mem_usage` was None, now default to True since model is quantized.
Loading checkpoint shards:   0%|          | 0/5 [00:00<?, ?it/s]Loading checkpoint shards:  20%|██        | 1/5 [00:07<00:31,  7.92s/it]Loading checkpoint shards:  40%|████      | 2/5 [00:14<00:20,  6.94s/it]Loading checkpoint shards:  60%|██████    | 3/5 [00:20<00:13,  6.66s/it]Loading checkpoint shards:  80%|████████  | 4/5 [00:26<00:06,  6.40s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:28<00:00,  4.78s/it]Loading checkpoint shards: 100%|██████████| 5/5 [00:28<00:00,  5.68s/it]
WARNING:accelerate.utils.other:Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
trainable params: 11,796,480 || all params: 10,682,017,315 || trainable%: 0.1104
#############################
Epoch 1/3
Training:   0%|          | 0/11817 [00:00<?, ?it/s]Training:   0%|          | 0/11817 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/scratch/oe2015/ai_project/DeTikZify/detikzify/evaluate/train3.py", line 393, in <module>
    train_model(model.language_model, train_dataloader, optimizer, epochs=3)
  File "/scratch/oe2015/ai_project/DeTikZify/detikzify/evaluate/train3.py", line 366, in train_model
    for batch in tqdm(train_dataloader, desc="Training"):
  File "/scratch/oe2015/conda-envs/greedy/lib/python3.9/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/scratch/oe2015/conda-envs/greedy/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
  File "/scratch/oe2015/conda-envs/greedy/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/scratch/oe2015/conda-envs/greedy/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 55, in fetch
    return self.collate_fn(data)
  File "/scratch/oe2015/ai_project/DeTikZify/detikzify/evaluate/train3.py", line 259, in collate_fn
    image_batch_no_trunc = processor(
  File "/scratch/oe2015/conda-envs/greedy/lib/python3.9/site-packages/transformers/models/mllama/processing_mllama.py", line 304, in __call__
    raise ValueError(
ValueError: The number of image token (1) should be the same as in the number of provided images (8)
